!function(){"use strict";var t,e,i=(jQuery,t=window.Backbone,e=window._,t.View.extend({initialize:function(){this.controls={}},addControl:function(t){this.controls[t.get("id")]=t},getValues:function(){return e.mapObject(this.controls,function(t){return t.getValue()})}}));var n,l=(function(t,e){var n;n=function(){function m(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}return function t(f){function p(t,e,n){var i;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(n=m({path:"/"},p.defaults,n)).expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*n.expires),n.expires=s}n.expires=n.expires?n.expires.toUTCString():"";try{i=JSON.stringify(e),/^[\{\[]/.test(i)&&(e=i)}catch(t){}e=f.write?f.write(e,t):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var r="";for(var a in n)n[a]&&(r+="; "+a,!0!==n[a]&&(r+="="+n[a]));return document.cookie=t+"="+e+r}t||(i={});for(var o=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,c=0;c<o.length;c++){var u=o[c].split("="),h=u.slice(1).join("=");this.json||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var d=u[0].replace(l,decodeURIComponent);if(h=f.read?f.read(h,d):f(h,d)||h.replace(l,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(t){}if(t===d){i=h;break}t||(i[d]=h)}catch(t){}}return i}}return(p.set=p).get=function(t){return p.call(p,t)},p.getJSON=function(){return p.apply({json:!0},[].slice.call(arguments))},p.defaults={},p.remove=function(t,e){p(t,"",m(e,{expires:-1}))},p.withConverter=t,p}(function(){})},t.exports=n()}(n={exports:{}},n.exports),n.exports),s=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r={parentTrigger:"li",subMenu:"ul",toggle:!0,triggerElement:"a"},c="active",u="collapse",o="in",h="collapsing",a=function(){function t(t,e){this.element="string"==typeof t?document.querySelector(t):t,this.cacheEl=this.element,this.config=s({},r,e),this.cacheConfig=this.config,this.disposed=!1,this.ulArr=[],this.listenerOb=[],this.init()}return t.prototype.update=function(){this.disposed=!1,this.element=this.cacheEl,this.config=this.cacheConfig,this.init()},t.prototype.dispose=function(){for(var t=0,e=this.listenerOb;t<e.length;t++){var n=e[t];for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s[1].removeEventListener(s[0],s[2])}}this.ulArr=[],this.listenerOb=[],this.config=null,this.element=null,this.disposed=!0},t.prototype.on=function(t,e){return this.element.addEventListener(t,e,!1),this},t.prototype.off=function(t,e){return this.element.removeEventListener(t,e),this},t.prototype.emit=function(t,e,n){var i;return void 0===n&&(n=!1),"function"==typeof CustomEvent?i=new CustomEvent(t,{bubbles:n,detail:e}):(i=document.createEvent("CustomEvent")).initCustomEvent(t,n,!1,e),this.element.dispatchEvent(i),this},t.prototype.init=function(){this.ulArr=[].slice.call(this.element.querySelectorAll(this.config.subMenu));for(var t=0,e=this.ulArr;t<e.length;t++){var n=e[t],i=n.parentNode;n.classList.add(u),i.classList.contains(c)?this.show(n):this.hide(n);var s=i.querySelector(this.config.triggerElement);if("true"===s.getAttribute("aria-disabled"))return;s.setAttribute("aria-expanded","false");var r={aClick:["click",s,this.clickEvent.bind(this)]};for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];o[1].addEventListener(o[0],o[2])}this.listenerOb.push(r)}},t.prototype.clickEvent=function(t){if(!this.disposed){"A"===t.currentTarget.tagName&&t.preventDefault();var e=t.currentTarget.parentNode.querySelector(this.config.subMenu);this.toggle(e)}},t.prototype.toggle=function(t){t.parentNode.classList.contains(c)?this.hide(t):this.show(t)},t.prototype.show=function(e){var n=this;if(!this.isTransitioning&&!e.classList.contains(o)){var i=e.parentNode;i.classList.add(c),i.querySelector(this.config.triggerElement).setAttribute("aria-expanded","true"),e.style.height="0px",e.classList.remove(u),e.classList.remove(o),e.classList.add(h);var t=[].slice.call(i.parentNode.children).filter(function(t){return t!==i});if(this.config.toggle&&0<t.length)for(var s=0,r=t;s<r.length;s++){var a=r[s].querySelector(this.config.subMenu);null!==a&&this.hide(a)}this.setTransitioning(!0),e.classList.add(u),e.classList.add(o),e.style.height=e.scrollHeight+"px",this.emit("show.metisMenu",{showElement:e}),e.addEventListener("transitionend",function t(){e.classList.remove(h),e.style.height="",e.removeEventListener("transitionend",t),n.setTransitioning(!1),n.emit("shown.metisMenu",{shownElement:e})})}},t.prototype.hide=function(e){var n=this;if(!this.isTransitioning&&e.classList.contains(o)){this.emit("hide.metisMenu",{hideElement:e});var t=e.parentNode;t.classList.remove(c);e.style.height=e.getBoundingClientRect().height+"px",e.style.height=e.offsetHeight+"px",e.classList.add(h),e.classList.remove(u),e.classList.remove(o),this.setTransitioning(!0),e.addEventListener("transitionend",function t(){e.classList.remove(h),e.classList.add(u),e.removeEventListener("transitionend",t),n.setTransitioning(!1),n.emit("hidden.metisMenu",{hiddenElement:e})}),e.style.height="0px",t.querySelector(this.config.triggerElement).setAttribute("aria-expanded","false")}},t.prototype.setTransitioning=function(t){this.isTransitioning=t},t}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function m(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,s=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(i=(a=o.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==o.return||o.return()}finally{if(s)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var b,v,y,w,k,x,E,C,T,L,S,A,D,O,I,F,P=["hide","show"],N=function(){function e(t){if(f(this,e),!t||!t.nodeName)throw new Error("No DOM node provided. Abort.");this.el=t,this._tablist={},this._callbacks={},this._handleDisplay=this._handleDisplay.bind(this),this._handleFocus=this._handleFocus.bind(this),this._handleTab=this._handleTab.bind(this),this._handlePanelFocus=this._handlePanelFocus.bind(this),this._handlePanel=this._handlePanel.bind(this)}return m(e,[{key:"_firstActiveTab",value:function(){for(var t,e=0;e<this._tablist.tabs.length;e++)if(!this._tablist.tabs[e].disabled){t=e;break}return t}},{key:"_handleDisplay",value:function(t){t.preventDefault();var e=t.currentTarget;e.disabled||(e!==document.activeElement&&e.focus(),this._toggleDisplay(this._tablist.tabs.indexOf(e)))}},{key:"_handleFocus",value:function(t){var e=t.currentTarget;e.disabled||(this._tablist.currentTabIndex=this._tablist.tabs.indexOf(e),this._select(this._tablist.tabs[this._tablist.currentTabIndex]))}},{key:"_handlePanel",value:function(t){switch(void 0===this._tablist.currentTabIndex&&this._handlePanelFocus(t),t.keyCode){case 33:t.ctrlKey&&(t.preventDefault(),this._switchTab(this._tablist.currentTabIndex-1));break;case 34:t.ctrlKey&&(t.preventDefault(),this._switchTab(this._tablist.currentTabIndex+1));break;case 38:t.ctrlKey&&(t.preventDefault(),this._switchTab(this._tablist.currentTabIndex))}}},{key:"_handlePanelFocus",value:function(t){if(t.target.doubleFocus)return t.preventDefault(),void delete t.target.doubleFocus;var e=t.currentTarget;this._tablist.currentTabIndex=this._tablist.tabPanels.indexOf(e),0<=["radio","checkbox"].indexOf(t.target.type)&&(t.target.doubleFocus=!0)}},{key:"_handleTab",value:function(t){switch(void 0===this._tablist.currentTabIndex&&this._handleFocus(t),t.keyCode){case 32:case 13:this._handleDisplay(t);break;case 35:t.preventDefault(),this._switchTab(this._tablist.tabs.length-1);break;case 36:t.preventDefault(),this._switchTab(this._firstActiveTab());break;case 37:case 38:t.preventDefault(),this._switchTab(this._tablist.currentTabIndex-1);break;case 39:case 40:t.preventDefault(),this._switchTab(this._tablist.currentTabIndex+1)}}},{key:"_noop",value:function(){}},{key:"_select",value:function(i){var s=this;this._tablist.tabs.forEach(function(t,e){var n=i===t;t.setAttribute("aria-selected",n),t.setAttribute("tabindex",n?0:-1),n&&s._toggleDisplay(e)})}},{key:"_switchTab",value:function(t){if(this._tablist.tabs[t]&&this._tablist.tabs[t].disabled){var e=t>this._tablist.currentTabIndex?t+1:t-1;this._switchTab(e)}else this._tablist.currentTabIndex=t,this._tablist.currentTabIndex<this._firstActiveTab()?this._tablist.currentTabIndex=this._tablist.tabsLength-1:this._tablist.currentTabIndex>=this._tablist.tabsLength&&(this._tablist.currentTabIndex=this._firstActiveTab()),this._tablist.tabs[this._tablist.currentTabIndex].focus()}},{key:"_toggleDisplay",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(!e||t!==this._tablist.openedIndex){var n=this._tablist.tabs[t],i=this._tablist.tabPanels[t];e&&void 0!==this._tablist.openedIndex&&this._toggleDisplay(this._tablist.openedIndex,!1),i.setAttribute("aria-hidden",!e),e?(this._tablist.openedIndex=t,void 0!==this._tablist.openedIndex&&this._trigger("show",[n,i])):void 0!==this._tablist.openedIndex&&this._trigger("hide",[n,i])}}},{key:"_trigger",value:function(t,e){var n=this;this._callbacks[t]&&this._callbacks[t].forEach(function(t){t.apply(n,e)})}},{key:"mount",value:function(){var r,a=this;this._tablist.tabs=[],this._tablist.tabPanels=[],Array.from(this.el.querySelectorAll("[role=tab]")).forEach(function(t,e){var n,i=t.getAttribute("aria-controls"),s=!1;if(i?n=document.getElementById(i):t.nextElementSibling&&t.nextElementSibling.getAttribute("aria-labelledby")===t.id&&(n=t.nextElementSibling),!n)throw new Error("Could not find associated tabpanel for tab ".concat(t.id,'. Use [aria-controls="tabpanelId"] on the [role="tab"] element to link them together'));a._tablist.tabs.push(t),a._tablist.tabPanels.push(n),t.disabled=t.hasAttribute("disabled")||"true"===t.getAttribute("aria-disabled"),"true"!==t.getAttribute("data-open")||t.disabled||void 0===a._tablist.openedIndex&&(a._toggleDisplay(e,!0),s=!0),t.removeAttribute("data-open"),void 0!==r||t.disabled||(r=e),t.setAttribute("tabindex",-1),n.setAttribute("aria-hidden",!s),t.addEventListener("click",a._handleDisplay),t.addEventListener("focus",a._handleFocus),t.addEventListener("keydown",a._handleTab),n.addEventListener("focus",a._handlePanelFocus,!0),n.addEventListener("keydown",a._handlePanel)}),this._tablist.tabsLength=this._tablist.tabs.length,this._tablist.tabPanelsLength=this._tablist.tabPanels.length,void 0!==this._tablist.openedIndex?(this._tablist.tabs[this._tablist.openedIndex].setAttribute("tabindex",0),this._tablist.tabs[this._tablist.openedIndex].setAttribute("aria-selected","true")):(this._toggleDisplay(r,!0),this._tablist.tabs[r].setAttribute("tabindex",0),this._tablist.tabs[r].setAttribute("aria-selected","true"))}},{key:"off",value:function(t,e){if(this._callbacks[t]){var n=this._callbacks[t].indexOf(e);n<0||this._callbacks[t].splice(n,1)}}},{key:"on",value:function(t,e){P.indexOf(t)<0||(this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e))}},{key:"unmount",value:function(){var i=this;this._tablist.tabs.forEach(function(t,e){var n=i._tablist.tabPanels[e];t.removeEventListener("click",i._handleDisplay),t.removeEventListener("focus",i._handleFocus),t.removeEventListener("keydown",i._handleTab),t.removeAttribute("tabindex"),t.removeAttribute("aria-selected"),n.removeEventListener("focus",i._handlePanelFocus,!0),n.removeEventListener("keydown",i._handlePanel),n.setAttribute("aria-hidden","false")}),this._tablist={}}},{key:"current",get:function(){return{tab:this._tablist.tabs[this._tablist.openedIndex],tabPanel:this._tablist.tabPanels[this._tablist.openedIndex]}}}]),e}(),V=(b=jQuery,i.extend({initialize:function(){i.prototype.initialize.apply(this,arguments),this.box=String(this.el.getAttribute("id")).replace("cmb2-metabox-",""),this.navElement=this.el.querySelector('[role="tablist"]'),this.navElement&&(this._menu=new a(this.navElement),this._tablist=new N(this.navElement),this._setupTabs()),this.initControls()},initControls:function(){var i=this;this.$el.find(".wplibs-form__row").each(function(){var n=b(this).data("fieldtype"),t=b(this).hasClass("cmb-repeat");if("title"===n||"__"===n.substr(0,2))return"";"group"!==n?(t?b(this).find(".cmb-repeat-row").each(function(){i.createNewControl(n,this,i)}):i.createNewControl(n,this,i),b(this).on("cmb2_add_row",function(t){var e=b(t.target).find(".cmb-repeat-row").last();i.createNewControl(n,e,i)})):i.initGroupControl(this)})},initGroupControl:function(t){var n=this;b(t).find(".cmb-repeatable-grouping").each(function(){var e=new i({el:this});b(this).find(".wplibs-form__grouprow").each(function(){var t=b(this).data("fieldtype");b(this).hasClass("cmb-repeat")?b(this).find(".cmb-repeat-row").each(function(){n.createNewControl(t,this)}):n.createNewControl(t,this,e)})})},createNewControl:function(t,e,n){var i=window.WPLibsForm||{},s=i.Controls.Control;return i.Controls.hasOwnProperty(t)&&(s=i.Controls[t]),new s({el:e,manager:n})},_setupTabs:function(){var r=this,a=this._menu,t=this._tablist,e=b(this.navElement),o="";e.on("click",'> [role="tab"] > a',function(){var t=e.find("> [data-panel].active > ul")[0];void 0!==t&&setTimeout(function(){return a.hide(t)},0)}),a.on("show.metisMenu",function(t){var e=t.detail.showElement;e.parentNode.classList.contains("hover")&&e.parentNode.classList.remove("hover"),e.querySelector(".active")}),t.on("show",function(t,e){var n,i;n=t.getAttribute("data-section"),(i=l.getJSON("_wplibs_current_sections")||{})[r.box]=n,l.set("_wplibs_current_sections",i,{path:""});var s=t.parentNode;s.classList.contains("sugar-options__submenu")&&a.show(s),t.classList.add("active"),e.classList.add("open"),o=b(e).outerHeight(),b(e.parentNode).animate({height:o},230,function(){b(e.parentNode).height("")})}),t.on("hide",function(t,e){o=b(e).outerHeight(),b(e.parentNode).height(o),t.classList.remove("active"),e.classList.remove("open")}),t.mount()}})),j=function(i){function t(t){var e=this,n=!1;return i(this).one("srTransitionEnd",function(){n=!0}),setTimeout(function(){n||i(e).trigger("transitionend")},t),this}return function(){i.fn.srEmulateTransitionEnd=t,i.event.special.srTransitionEnd={bindType:"transitionend",delegateType:"transitionend",handle:function(t){if(i(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}}}(jQuery),z=(v=jQuery,j(),{TRANSITION_END:"srTransitionEnd",getTargetFromElement:function(t){var e=t.getAttribute("data-target");e&&"#"!==e||(e=t.getAttribute("href")||"");try{return document.querySelector(e)?e:null}catch(t){return null}},triggerTransitionEnd:function(t){v(t).trigger("transitionend")},getTransitionDurationFromElement:function(t){if(!t)return 0;var e=v(t).css("transition-duration");return parseFloat(e)?(e=e.split(",")[0],1e3*parseFloat(e)):0},isKeydownButNotEnterEvent:function(t){return"keydown"===t.type&&13!==t.which},getFieldData:function(e,n){if(window.cmb2_l10){var t=window.cmb2_l10.fields||{};return e instanceof jQuery&&(e=e[0]),_.isElement(e)&&e.hasAttribute("data-hash")&&(e=e.getAttribute("data-hash")),t.hasOwnProperty(e)?t[e]:_.find(t,function(t){return t.id===e&&t.box===n})}}}),B=function(){function s(t){return"[object String]"===Object.prototype.toString.call(t)}function a(t){return(!Array.isArray(t)||0!==t.length)&&!!t}var o=function(){function n(t,e){f(this,n),this.name=t,this.instance=e}return m(n,[{key:"getName",value:function(){return this.name}},{key:"getValue",value:function(){if(this.instance.data.hasOwnProperty(this.name))return this.instance.data[this.name]}}]),n}(),t=function(){function r(t){f(this,r),this.data=t||{}}return m(r,[{key:"apply",value:function(t){var e="and";return r.isProposition(t)?t=[t]:r.isLogicSet(t)&&(t=t[e=this.getOperator(t)]),this.testLogical(t,e)}},{key:"testLogical",value:function(t,e){if(Array.isArray(t)||(t=Object.values(t)),0===t.length)return!0;var n;switch(e){case"and":for(var i=0;i<t.length;i++){try{n=this.testProposition(t[i])}catch(t){console.error&&console.error(t);continue}if(!a(n))return n}return n;case"or":for(var s=0;s<t.length;s++){try{n=this.testProposition(t[s])}catch(t){console.error&&console.error(t);continue}if(a(n))return n}return n}return!0}},{key:"testProposition",value:function(t){var e=g(this.normalizeProposition.apply(this,t),3),n=e[0],i=e[1],s=e[2];if(s instanceof o&&(s=s.getValue()),"function"==typeof r.operators[i])return r.operators[i].call(null,n.getValue(),s);throw new Error("Unrecognized operation ".concat(i))}},{key:"getOperator",value:function(t){return Object.keys(t)[0]}},{key:"newVariable",value:function(t){return new o(t,this)}},{key:"normalizeProposition",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(2===arguments.length&&0!==e.indexOf("is_")){var i=[e,"="];n=i[0],e=i[1]}return e=this.normalizeOperator(e),s(n)&&["in","not_in"].includes(e)&&(n=n.split(",").map(function(t){return t.trim()})),s(n)&&"@"===n[0]&&(n=this.newVariable(n.substr(1))),[this.newVariable(t),e,n]}},{key:"normalizeOperator",value:function(t){switch(t){case"=":case"==":return"equal";case"!=":case"!==":return"not_equal";case"<":case"lt":return"less_than";case"<=":case"lte":return"less_than_or_equal";case">":case"gt":return"greater_than";case">=":case"gte":return"greater_than_or_equal";case"is_truthy":return"is_not_empty";default:return t}}}]),r}();return t.isLogicSet=function(t){return!Array.isArray(t)&&null!==t&&("object"===d(t)&&1===Object.keys(t).length)},t.isProposition=function(t){return Array.isArray(t)&&2<=t.length&&s(t[0])},t.operators={equal:function(t,e){return t==e},not_equal:function(t,e){return t!=e},greater_than:function(t,e){return e<t},greater_than_or_equal:function(t,e){return e<=t},less_than:function(t,e){return t<e},less_than_or_equal:function(t,e){return t<=e},between:function(t,e){return t<=t&&t<=e},not_between:function(t,e){return!(t<=t&&t<=e)},in:function(t,e){return Array.isArray(e)&&e.includes(t)},not_in:function(t,e){return Array.isArray(e)&&!e.includes(t)},contains:function(t,e){return s(t)&&t.includes(e)},not_contains:function(t,e){return s(t)&&!t.includes(e)},begins_with:function(t,e){return s(t)&&t.startsWith(e)},not_begins_with:function(t,e){return s(t)&&!t.startsWith(e)},ends_with:function(t,e){return s(t)&&t.endsWith(e)},not_ends_with:function(t,e){return s(t)&&!t.endsWith(e)},is_empty:function(t){return!a(t)},is_not_empty:function(t){return a(t)}},t}(),q=(y=jQuery,w=Backbone,k=window._,(x=w.Model.extend({defaults:{id:"",value:""},constructor:function(t,e){this.element=y(t),w.Model.prototype.constructor.call(this,e||{})},initialize:function(){var n=this,t="",e=x.Synchronizer.html;if(this.element.is("input, select, textarea")){var i=this.element.prop("type");t+=" change input",e=x.Synchronizer.value,this.element.is("input")&&x.Synchronizer[i]&&(e=x.Synchronizer[i]),k.extend(this,e)}var s=this.update,r=this.refresh;this.update=function(t){t!==r.call(n)&&s.call(n,t)},this.refresh=function(){n.setValue(r.call(n))},this.set({value:r.call(this)},{silent:!0}),this.element.on(t,this.refresh),this.on("change:value",function(t,e){return n.update(e)})},refresh:function(){},update:function(){},getValue:function(){return this.get("value")},setValue:function(t){this.set("value",t)},isDirty:function(){return this.hasChanged("value")}})).Synchronizer={},x.Synchronizer.html={update:function(t){this.element.html(t)},refresh:function(){return this.element.html()}},x.Synchronizer.value={update:function(t){this.element.val(t)},refresh:function(){return this.element.val()}},x.Synchronizer.checkbox={update:function(t){this.element.prop("checked",t)},refresh:function(){return this.element.prop("checked")}},x.Synchronizer.radio={update:function(t){var e=this;this.element.filter(function(){return e.getValue()===t}).prop("checked",!0)},refresh:function(){return this.element.filter(":checked").val()}},x),R=(E=jQuery,C=window.Backbone,T=window._,C.View.extend({initialize:function(t){this.manager=t.manager,this.model=new C.Model(t.settings||this._getControlSettings()),this.model.has("type")||this.model.set("type",this.getRowElement().data("fieldtype")),this.manager&&this.manager.addControl(this),this.controlContainer=this.find(".wplibs-form__control-area")[0],this.controlContainer&&document.getElementById("tmpl-"+this.getTemplateName())&&(this.template=wp.template(this.getTemplateName()),this.render()),this.elements={},this.linkElements(),this.elementsCollect=new C.Collection(Object.values(this.elements)),this.template&&(this.on("change",T.debounce(this.render,100)),this.listenTo(this.model,"change",T.debounce(this.render,100))),this.manager&&(this.listenTo(this.elementsCollect,"change",T.debounce(this.change,50)),this.listenTo(this.manager,"changes",T.debounce(this.toggleControlVisibility,50))),this.ready()},ready:function(){},linkElements:function(){var s=this,r=s.$el.find("[data-hash]"),a={};r.each(function(t,e){var n=E(e);if(!n.data("_controlSettingLinked")){if(n.data("_controlSettingLinked",!0),n.is(":radio")){var i=n.prop("name");if(a[i])return;a[i]=!0,n=r.filter('[name="'+i+'"]')}n.data("element")&&(t=n.data("element")),s.elements[t]=new q(n,{id:t})}})},change:function(){this.manager.trigger("changes",this)},render:function(){var t=this.getTemplateData();return this.template&&this.controlContainer&&E(this.controlContainer).html(this.template(t)),this},getTemplateData:function(){return this.model.toJSON()},toggleControlVisibility:function(){var t=this._getDependencyRules();if(void 0!==t){var e=this.getRowElement(),n=new B(this.manager.getValues()).apply(t);n!==this.model.get("active")&&(n?e.attr("data-satisfied","true"):e.attr("data-satisfied","false"),n&&E.fn.effect&&e.effect("highlight"),this.model.set("active",n))}},get:function(t){return this.model.get(t)},getValue:function(t){if(T.isEmpty(this.elements))return null;var e=Object.values(this.elements);return 1===e.length?e[0].getValue():t?this.elements.hasOwnProperty(t)?this.elements[t].getValue():void 0:T.mapObject(this.elements,function(t){return t.getValue()})},setValue:function(t,n){void 0===n&&(n=t);var e=Object.values(this.elements);1===e.length&&e[0].setValue(n),this.elements.hasOwnProperty(t)&&this.elements[t].setValue(n),T.each(this.elements,function(t,e){T.isObject(n)&&n.hasOwnProperty(e)&&t.setValue(n[e])})},isGroup:function(){return!!this.model.get("is_group")},isRepeatable:function(){return this.getRowElement().hasClass("cmb-repeat")},find:function(t){return this.$el.find(t)},getRowElement:function(){return this.$el.closest(".wplibs-form__grouprow, .wplibs-form__row")},getFormElement:function(){return this.$el.closest("form")},getTemplateName:function(){return"wplibs-field-"+this.model.get("type")+"-content"},_getDependencyRules:function(){var t=this.model.get("deps");if(!t)try{t=JSON.parse(this.getRowElement().data("deps"))}catch(t){return}return B.isLogicSet(t)||B.isProposition(t)?t:void 0},_getControlSettings:function(){var t=this.getRowElement(),e=z.getFieldData(t[0])||{},n=t.data("settings");return T.isObject(n)&&T.isEmpty(n)?T.extend(e,n):e}})),M=(jQuery,R.extend({events:{"click .upload-button":"openFrame","click .change-button":"openFrame","click .thumbnail-image img":"openFrame","click .default-button":"restoreDefault","click .remove-button":"removeFile"},openFrame:function(t){z.isKeydownButNotEnterEvent(t)||(t.preventDefault(),this.frame||this.initFrame(),this.frame.open())},initFrame:function(){this.frame=wp.media({button:{text:"Select"},states:[new wp.media.controller.Library({title:"Title",library:wp.media.query({type:"image"}),multiple:!1,date:!1})]}),this.frame.on("select",this.select.bind(this))},select:function(){this.model.set("attachment",this.frame.state().get("selection").first().toJSON()),this.setValue(this.model.get("attachment").id)},removeFile:function(t){z.isKeydownButNotEnterEvent(t)||(t.preventDefault(),this.setValue(null),this.model.set("attachment",void 0))},restoreDefault:function(t){z.isKeydownButNotEnterEvent(t)||t.preventDefault()}})),Q=(jQuery,M.extend({})),W=(jQuery,Q.extend({openFrame:function(t){z.isKeydownButNotEnterEvent(t)||(this.initFrame(),this.frame.setState("library").open())},initFrame:function(){var t=window._wpMediaViewsL10n||{},e=this.model.get("labels");this.frame=wp.media({button:{text:t.select,close:!1},states:[new wp.media.controller.Library({title:e.frame_title,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:this.model.get("width"),suggestedHeight:this.model.get("height")}),new wp.media.controller.Cropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){var t=this.frame.state().get("selection").first().toJSON();this.model.get("width")!==t.width||this.model.get("height")!==t.height||this.model.get("flex_width")||this.model.get("flex_height")?this.frame.setState("cropper"):(this.setImageFromAttachment(t),this.frame.close())},onCropped:function(t){this.setImageFromAttachment(t)},calculateImageSelectOptions:function(t,e){var n,i,s,r=e.get("control"),a=!!parseInt(r.model.get("flex_width"),10),o=!!parseInt(r.model.get("flex_height"),10),l=t.get("width"),c=t.get("height"),u=parseInt(r.model.get("width"),10),h=parseInt(r.model.get("height"),10),d=u/h,f=u,p=h;return e.set("canSkipCrop",!r.mustBeCropped(a,o,u,h,l,c)),d<l/c?u=(h=c)*d:h=(u=l)/d,!(s={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:l,imageHeight:c,minWidth:u<f?u:f,minHeight:h<p?h:p,x1:n=(l-u)/2,y1:i=(c-h)/2,x2:u+n,y2:h+i})===o&&!1===a&&(s.aspectRatio=u+":"+h),!0===o&&(delete s.minHeight,s.maxWidth=l),!0===a&&(delete s.minWidth,s.maxHeight=c),s},mustBeCropped:function(t,e,n,i,s,r){return!(!0===t&&!0===e||!0===t&&i===r||!0===e&&n===s||n===s&&i===r||!(n<s))},onSkippedCrop:function(){var t=this.frame.state().get("selection").first().toJSON();this.setImageFromAttachment(t)},setImageFromAttachment:function(t){this.model.set("attachment",t),this.setValue(t.id)}})),H=(jQuery,L=window.SuruLibs||{},R.extend({ready:function(){console.log(this.elements);var i=this.find('[data-element="weight"]').selectize({valueField:"id",labelField:"name",searchField:["name"]});this.find('[data-element="family"]').selectize({options:L.webfonts.getGoogleFonts(),optgroups:[],valueField:"family",labelField:"family",searchField:["name"],onChange:function(t){var e=this.options[t];if(i[0]&&i[0].selectize){var n=i[0].selectize;n.clearOptions(),n.load(function(t){t(L.webfonts.toVariants(e.variants))})}}})}})),J=(S=jQuery,A=["top","right","bottom","left"],R.extend({events:{'click [data-toggle="link"]':"onLinkDimensionsClicked",'change [type="text"],[type="number"]':"onInputChange"},ready:function(){this.linkElement=this.find('[data-toggle="link"]'),this.isLinkedDimensions()||this.linkElement.addClass("unlinked"),this.fillEmptyDimensions()},fillEmptyDimensions:function(){var e=this;this.isLinkedDimensions()||_.each(this.geDimensionElements(),function(t){t.getValue()||t.setValue(e.model.get("default")||0)})},onInputChange:function(t){var e=S(t.target),n=e.data("element");"unit"!==n?A.includes(n)&&this.isLinkedDimensions()&&this.setDimensionsValue(e.val()):this.setDimensionsValue("")},onLinkDimensionsClicked:function(t){t.preventDefault(),t.stopPropagation();var e=this.geDimensionElements();if(this.linkElement.toggleClass("unlinked"),this.elements.linked.setValue(this.linkElement.hasClass("unlinked")?0:1),this.isLinkedDimensions()){var n=Object.values(e)[0].getValue();this.setDimensionsValue(n)}},setDimensionsValue:function(e){_.each(this.geDimensionElements(),function(t){t.setValue(e)})},geDimensionElements:function(){var e=this,n={};return _.each(A,function(t){e.elements.hasOwnProperty(t)&&(n[t]=e.elements[t])}),n},isLinkedDimensions:function(){return!!parseInt(this.getValue("linked"),10)},filterDimensions:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";if("all"===t||"*"==t)return A;if(!Array.isArray(t)){if("horizontal"===t)return["right","left"];if("vertical"===t)return["top","bottom"]}return t}})),U=(jQuery,D=window.wpLink||{},R.extend({events:{"click .js-open-link":"openLinkDialog","click .js-toggle-link-options":"toggleOptions"},ready:function(){this.find("textarea").on("change",this.onLinkSelect.bind(this))},onLinkSelect:function(t){var e=D.getAttrs();this.setValue("url",e.href),this.setValue("is_external",!!e.target),t.currentTarget.value=""},openLinkDialog:function(t){t.preventDefault();var e=this.find("textarea");D.open(e.attr("id"))},toggleOptions:function(t){t.preventDefault(),this.find(".wplibs-control-link__options").toggle()}})),K=(O=jQuery,R.extend({ready:function(){this.$el.find(".cmb2-ui-slider-input").each(function(){var e=O(this);if(!e.closest(".empty-row").length){var n=e.parent().find(".cmb2-ui-slider-preview"),i=e.parent().find(".cmb2-ui-slider").slider({range:"min",min:e.data("min"),max:e.data("max"),step:e.data("step"),value:e.data("value"),animate:!0,slide:function(t,e){s(e.value)}});e.data("float")&&_.isObject(e.data("float"))&&i.slider("float",e.data("float")),e.data("pips")&&_.isObject(e.data("pips"))&&i.slider("pips",e.data("pips"));var s=function(t){n.text(t),e.val(t).trigger("change")};s(i.slider("value")),e.on("change blur",function(){var t=parseInt(O(this).val());i.slider("value",t),i.slider("value")!==t&&O(this).val(i.slider("value"))})}})}}));window.WPLibsForm={},I=jQuery,(F=window.WPLibsForm).Controls={},F.Controls.Control=R,F.Controls.link=U,F.Controls.slider=K,F.Controls.dimensions=J,F.Controls.typography=H,F.Controls.media=M,F.Controls.image=Q,F.Controls.cropped_image=W,F.instances=[],F.confirm=function(t,e){if(!window.swal)return window.confirm(t||this.i18n.warning)&&e();var n=window.swal({text:t||this.i18n.warning,customClass:"suru-confirm-dialog",position:"center",animation:!1,backdrop:"rgba(0,0,0,.8)",reverseButtons:!0,buttonsStyling:!1,showCancelButton:!0,cancelButtonClass:"",confirmButtonClass:"",cancelButtonText:this.i18n.cancel,confirmButtonText:this.i18n.ok});return e?n.then(function(t){t.value&&e(t)}):n},I(function(){I("select.wplibs-selectize").selectize({allowEmptyOption:!0,searchField:["value","text"]}),I(".wplibs-box > .cmb2-metabox").each(function(t,e){if(!e._wpLibsForm){var n=new V({el:e});F.instances.push(n),e._wpLibsForm=n}})})}();